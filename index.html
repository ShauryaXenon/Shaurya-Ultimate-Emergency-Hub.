
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#ff0000">
    <title> ULTIMATE EMERGENCY SAFETY HUB - Made by SHAURYA MITTAL</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Ultimate Emergency Safety Website with Real Working Features - Compass, GPS, Camera, SOS, AI Assistant">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <style>
        /*  ULTRA PERFORMANCE CSS - 240+ FPS OPTIMIZED */
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #2a2a2a;
            --accent-primary: #ff0040;
            --accent-secondary: #00d4ff;
            --accent-success: #00ff88;
            --accent-warning: #ffaa00;
            --accent-danger: #ff0040;
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --text-muted: #888888;
            --border-color: rgba(255, 0, 64, 0.3);
            --glass-bg: rgba(26, 26, 26, 0.8);
            --shadow-glow: 0 0 30px rgba(255, 0, 64, 0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Futuristic Background Pattern */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(255, 0, 64, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(0, 212, 255, 0.1) 0%, transparent 50%),
                linear-gradient(90deg, transparent 24%, rgba(255, 255, 255, 0.02) 25%, rgba(255, 255, 255, 0.02) 26%, transparent 27%, transparent 74%, rgba(255, 255, 255, 0.02) 75%, rgba(255, 255, 255, 0.02) 76%, transparent 77%, transparent);
            pointer-events: none;
            z-index: -1;
        }

        /* Attribution */
        .attribution {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 10000;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 12px 20px;
            font-size: 14px;
            font-weight: 600;
            color: var(--accent-primary);
            box-shadow: var(--shadow-glow);
        }

        /* Header */
        .header {
            position: fixed;
            top: 0;
            right: 0;
            left: 0;
            z-index: 1000;
            background: rgba(26, 26, 26, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-color);
            padding: 20px 30px;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1600px;
            margin: 0 auto;
        }

        .logo {
            font-size: 24px;
            font-weight: 800;
            color: var(--accent-primary);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-menu {
            display: flex;
            gap: 40px;
            align-items: center;
        }

        .nav-item {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            font-size: 16px;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-item:hover {
            color: var(--accent-primary);
            transform: translateY(-2px);
        }

        .nav-item::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--accent-primary);
            transition: width 0.3s ease;
        }

        .nav-item:hover::after {
            width: 100%;
        }

        /* Region Selector */
        .region-selector {
            display: flex;
            gap: 10px;
        }

        .region-btn {
            background: transparent;
            border: 2px solid var(--border-color);
            color: var(--text-secondary);
            padding: 8px 16px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .region-btn:hover, .region-btn.active {
            background: var(--accent-primary);
            color: var(--text-primary);
            border-color: var(--accent-primary);
            box-shadow: 0 0 20px rgba(255, 0, 64, 0.4);
        }

        /* Main Content */
        .main-content {
            margin-top: 100px;
            padding: 60px 30px;
            max-width: 1600px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Hero Section */
        .hero-section {
            text-align: center;
            padding: 80px 0;
        }

        .hero-title {
            font-size: 64px;
            font-weight: 900;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary), var(--accent-success));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 20px;
            line-height: 1.1;
        }

        .hero-subtitle {
            font-size: 24px;
            color: var(--text-secondary);
            margin-bottom: 50px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.5;
        }

        /* ULTIMATE SOS BUTTON */
        .sos-container {
            margin: 60px 0;
            display: flex;
            justify-content: center;
        }

        .sos-button {
            position: relative;
            width: 250px;
            height: 250px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--accent-danger), #ff6b6b);
            border: 6px solid var(--text-primary);
            color: var(--text-primary);
            font-size: 32px;
            font-weight: 900;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 15px 50px rgba(255, 0, 64, 0.4);
            animation: pulse-sos 2s infinite;
        }

        @keyframes pulse-sos {
            0%, 100% { transform: scale(1); box-shadow: 0 15px 50px rgba(255, 0, 64, 0.4); }
            50% { transform: scale(1.05); box-shadow: 0 20px 60px rgba(255, 0, 64, 0.6); }
        }

        .sos-button:hover {
            transform: scale(1.1);
            box-shadow: 0 25px 70px rgba(255, 0, 64, 0.8);
        }

        .sos-button:active {
            transform: scale(0.95);
        }

        /* Emergency Grid */
        .emergency-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 60px 0;
        }

        .emergency-btn {
            background: rgba(26, 26, 26, 0.8);
            backdrop-filter: blur(10px);
            border: 2px solid var(--border-color);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-primary);
            text-decoration: none;
            position: relative;
            overflow: hidden;
        }

        .emergency-btn::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 0, 64, 0.1), transparent);
            transform: rotate(-45deg);
            transition: all 0.5s ease;
            opacity: 0;
        }

        .emergency-btn:hover::before {
            animation: shimmer 0.8s ease-in-out;
            opacity: 1;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(-45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(-45deg); }
        }

        .emergency-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(255, 0, 64, 0.3);
            border-color: var(--accent-primary);
        }

        .emergency-number {
            font-size: 32px;
            font-weight: 800;
            color: var(--accent-primary);
            margin: 15px 0;
        }

        .emergency-label {
            font-size: 14px;
            color: var(--text-secondary);
            text-transform: uppercase;
            font-weight: 600;
            letter-spacing: 1px;
        }

        /* Feature Grid */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin: 80px 0;
        }

        .feature-card {
            background: rgba(26, 26, 26, 0.8);
            backdrop-filter: blur(15px);
            border: 2px solid var(--border-color);
            border-radius: 25px;
            padding: 40px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary), var(--accent-success));
        }

        .feature-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 60px rgba(255, 0, 64, 0.2);
            border-color: var(--accent-primary);
        }

        .feature-icon {
            font-size: 48px;
            margin-bottom: 20px;
        }

        .feature-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--accent-primary);
            margin-bottom: 15px;
        }

        .feature-description {
            color: var(--text-secondary);
            margin-bottom: 25px;
            font-size: 16px;
            line-height: 1.6;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 12px 24px;
            border-radius: 15px;
            font-weight: 600;
            font-size: 16px;
            text-decoration: none;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transition: all 0.3s ease;
            transform: translate(-50%, -50%);
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--accent-primary), #ff6b6b);
            color: var(--text-primary);
        }

        .btn-success {
            background: linear-gradient(45deg, var(--accent-success), #4ade80);
            color: var(--bg-primary);
        }

        .btn-danger {
            background: linear-gradient(45deg, var(--accent-danger), #f87171);
            color: var(--text-primary);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 2px solid var(--border-color);
        }

        .btn-warning {
            background: linear-gradient(45deg, var(--accent-warning), #fbbf24);
            color: var(--bg-primary);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        /* Map Container */
        .map-container {
            width: 100%;
            height: 300px;
            border: 2px solid var(--border-color);
            border-radius: 20px;
            overflow: hidden;
            margin: 20px 0;
            position: relative;
            background: var(--bg-tertiary);
        }

        .map-display {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            color: var(--text-secondary);
            font-size: 20px;
            font-weight: 600;
        }

        /* Camera Container */
        .camera-container {
            width: 100%;
            height: 300px;
            border: 2px solid var(--border-color);
            border-radius: 20px;
            overflow: hidden;
            background: var(--bg-tertiary);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .camera-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .camera-overlay {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(255, 0, 64, 0.9);
            color: var(--text-primary);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 700;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.5; }
        }

        /* Compass */
        .compass {
            width: 200px;
            height: 200px;
            border: 4px solid var(--accent-primary);
            border-radius: 50%;
            margin: 20px auto;
            position: relative;
            background: radial-gradient(circle, var(--bg-tertiary), var(--bg-secondary));
            box-shadow: inset 0 0 30px rgba(255, 0, 64, 0.3);
        }

        .compass-needle {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 4px;
            height: 80px;
            background: linear-gradient(to top, var(--accent-primary), var(--accent-secondary));
            transform-origin: bottom center;
            transform: translate(-50%, -100%) rotate(0deg);
            transition: transform 0.5s ease;
            border-radius: 2px;
        }

        .compass-needle::before {
            content: '';
            position: absolute;
            top: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 16px solid var(--accent-primary);
        }

        .compass-directions {
            position: absolute;
            width: 100%;
            height: 100%;
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .compass-n { position: absolute; top: 15px; left: 50%; transform: translateX(-50%); }
        .compass-s { position: absolute; bottom: 15px; left: 50%; transform: translateX(-50%); }
        .compass-e { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); }
        .compass-w { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); }

        /* Flashlight Control */
        .flashlight-control {
            display: flex;
            align-items: center;
            gap: 20px;
            margin: 20px 0;
            justify-content: center;
        }

        .flashlight-btn {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--accent-warning), #fbbf24);
            border: none;
            color: var(--bg-primary);
            font-size: 32px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(255, 170, 0, 0.4);
        }

        .flashlight-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 35px rgba(255, 170, 0, 0.6);
        }

        .flashlight-btn.active {
            background: linear-gradient(45deg, #ffffff, #f0f0f0);
            box-shadow: 0 0 40px rgba(255, 255, 255, 0.8);
            animation: flash-glow 1s infinite;
        }

        @keyframes flash-glow {
            0%, 100% { box-shadow: 0 0 40px rgba(255, 255, 255, 0.8); }
            50% { box-shadow: 0 0 60px rgba(255, 255, 255, 1); }
        }

        /* Voice Chat */
        .voice-chat {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }

        .voice-btn {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--accent-secondary), #0ea5e9);
            border: none;
            color: var(--text-primary);
            font-size: 32px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(0, 212, 255, 0.4);
        }

        .voice-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 35px rgba(0, 212, 255, 0.6);
        }

        .voice-btn.listening {
            animation: voice-pulse 1.5s infinite;
        }

        @keyframes voice-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); box-shadow: 0 0 40px rgba(0, 212, 255, 0.8); }
        }

        /* Chat Interface */
        .chat-interface {
            position: fixed;
            bottom: 130px;
            right: 30px;
            width: 400px;
            height: 500px;
            background: rgba(26, 26, 26, 0.95);
            backdrop-filter: blur(20px);
            border: 2px solid var(--border-color);
            border-radius: 25px;
            display: none;
            flex-direction: column;
            z-index: 1001;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .chat-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--accent-primary) transparent;
        }

        .chat-messages::-webkit-scrollbar {
            width: 6px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: transparent;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: var(--accent-primary);
            border-radius: 3px;
        }

        .chat-input {
            padding: 20px;
            border-top: 1px solid var(--border-color);
        }

        .chat-input input {
            width: 100%;
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            border-radius: 15px;
            padding: 12px 20px;
            color: var(--text-primary);
            font-size: 16px;
        }

        .chat-input input:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 20px rgba(255, 0, 64, 0.3);
        }

        .message {
            margin-bottom: 15px;
            padding: 15px 20px;
            border-radius: 20px;
            font-size: 16px;
            line-height: 1.5;
        }

        .message.user {
            background: linear-gradient(45deg, var(--accent-primary), #ff6b6b);
            color: var(--text-primary);
            margin-left: 60px;
            border-bottom-right-radius: 5px;
        }

        .message.ai {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            margin-right: 60px;
            border-bottom-left-radius: 5px;
            border: 1px solid var(--border-color);
        }

        /* Status Bar */
        .status-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(26, 26, 26, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid var(--border-color);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
            z-index: 900;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text-secondary);
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--accent-success);
            animation: status-pulse 2s infinite;
        }

        @keyframes status-pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .status-dot.offline {
            background: var(--accent-danger);
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .modal-content {
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 25px;
            padding: 40px;
            max-width: 600px;
            width: 90%;
            position: relative;
            box-shadow: 0 30px 80px rgba(0, 0, 0, 0.5);
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 24px;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .modal-close:hover {
            color: var(--accent-primary);
        }

        /* SOS Flash Effect */
        .sos-flash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--accent-danger);
            z-index: 9999;
            opacity: 0;
            pointer-events: none;
        }

        .sos-flash.active {
            animation: sos-blink 0.5s infinite;
        }

        @keyframes sos-blink {
            0%, 50% { opacity: 0; }
            51%, 100% { opacity: 0.8; }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-menu {
                display: none;
            }
            
            .hero-title {
                font-size: 40px;
            }
            
            .hero-subtitle {
                font-size: 18px;
            }
            
            .feature-grid {
                grid-template-columns: 1fr;
            }
            
            .chat-interface {
                width: calc(100% - 60px);
                height: 70vh;
            }
            
            .sos-button {
                width: 200px;
                height: 200px;
                font-size: 24px;
            }
            
            .compass {
                width: 150px;
                height: 150px;
            }
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid var(--border-color);
            border-radius: 50%;
            border-top-color: var(--accent-primary);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 120px;
            right: 30px;
            z-index: 10000;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 2px solid var(--border-color);
            border-radius: 15px;
            padding: 20px;
            max-width: 400px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            transform: translateX(500px);
            transition: transform 0.5s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            border-color: var(--accent-success);
        }

        .notification.error {
            border-color: var(--accent-danger);
        }

        .notification.warning {
            border-color: var(--accent-warning);
        }

        /* Special Effects */
        .glow {
            box-shadow: 0 0 30px currentColor;
        }

        .shake {
            animation: shake 0.5s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
    </style>
</head>
<body>
    <!-- Attribution -->
    <div class="attribution">
         Made by SHAURYA MITTAL
    </div>

    <!-- SOS Flash Effect -->
    <div class="sos-flash" id="sosFlash"></div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <a href="#" class="logo">
                 ULTIMATE EMERGENCY HUB
            </a>
            <nav class="nav-menu">
                <a href="#" class="nav-item"> Dashboard</a>
                <a href="#" class="nav-item"> Emergency</a>
                <a href="#" class="nav-item"> Student Zone</a>
                <a href="#" class="nav-item"> Resources</a>
                <a href="#" class="nav-item"> Help</a>
            </nav>
            <div class="region-selector">
                <button class="region-btn active" onclick="selectRegion('global')"> Global</button>
                <button class="region-btn" onclick="selectRegion('india')"> India</button>
                <button class="region-btn" onclick="selectRegion('usa')"> USA</button>
                <button class="region-btn" onclick="selectRegion('uk')"> UK</button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Hero Section -->
        <section class="hero-section">
            <h1 class="hero-title">ULTIMATE EMERGENCY SAFETY HUB</h1>
            <p class="hero-subtitle">Professional-grade emergency response system with real-time GPS tracking, AI assistance, camera recording, working compass, flashlight control, and comprehensive student safety features.</p>
            
            <!-- ULTIMATE SOS BUTTON -->
            <div class="sos-container">
                <button class="sos-button" onclick="triggerUltimateEmergency()" title="ULTIMATE EMERGENCY - Activates ALL systems instantly">
                    <br>ULTIMATE<br>SOS<br>ALERT
                </button>
            </div>
        </section>

        <!-- Emergency Numbers Grid -->
        <section class="emergency-grid">
            <a href="tel:112" class="emergency-btn">
                <div style="font-size: 48px;">?????</div>
                <div class="emergency-number" id="police-number">112</div>
                <div class="emergency-label">Police Emergency</div>
            </a>
            <a href="tel:911" class="emergency-btn">
                <div style="font-size: 48px;">??</div>
                <div class="emergency-number" id="fire-number">911</div>
                <div class="emergency-label">Fire Department</div>
            </a>
            <a href="tel:911" class="emergency-btn">
                <div style="font-size: 48px;">??</div>
                <div class="emergency-number" id="ambulance-number">911</div>
                <div class="emergency-label">Medical Emergency</div>
            </a>
            <a href="tel:911" class="emergency-btn">
                <div style="font-size: 48px;">?????</div>
                <div class="emergency-number" id="women-number">911</div>
                <div class="emergency-label">Women Helpline</div>
            </a>
            <a href="tel:911" class="emergency-btn">
                <div style="font-size: 48px;">??</div>
                <div class="emergency-number" id="child-number">911</div>
                <div class="emergency-label">Child Protection</div>
            </a>
            <a href="tel:911" class="emergency-btn">
                <div style="font-size: 48px;">???</div>
                <div class="emergency-number" id="cyber-number">911</div>
                <div class="emergency-label">Cyber Crime</div>
            </a>
        </section>

        <!-- Feature Grid -->
        <section class="feature-grid">
            <!-- Live Camera & Recording -->
            <div class="feature-card">
                <div class="feature-icon">??</div>
                <h3 class="feature-title">Live Camera & Evidence Recording</h3>
                <p class="feature-description">Real-time camera access with HD video recording. Automatically saves evidence and streams to emergency contacts. Works with front and back cameras.</p>
                
                <div class="camera-container">
                    <video id="cameraVideo" class="camera-video" autoplay muted playsinline style="display:none;"></video>
                    <div id="cameraPlaceholder" class="map-display">
                        ??<br>Click Start Camera<br><small>Real camera access</small>
                    </div>
                    <div id="cameraOverlay" class="camera-overlay" style="display:none;">RECORDING EVIDENCE</div>
                </div>
                
                <button class="btn btn-success" onclick="startCamera()"> Start Camera</button>
                <button class="btn btn-danger" onclick="startRecording()"> Record Evidence</button>
                <button class="btn btn-secondary" onclick="stopCamera()"> Stop Camera</button>
            </div>

            <!-- Real Working Compass -->
            <div class="feature-card">
                <div class="feature-icon">??</div>
                <h3 class="feature-title">Real Working Digital Compass</h3>
                <p class="feature-description">Live compass using device orientation sensors. Real-time direction tracking with precise degree measurements for navigation and emergency location.</p>
                
                <div class="compass">
                    <div class="compass-needle" id="compassNeedle"></div>
                    <div class="compass-directions">
                        <div class="compass-n">N</div>
                        <div class="compass-s">S</div>
                        <div class="compass-e">E</div>
                        <div class="compass-w">W</div>
                    </div>
                </div>
                <div style="text-align: center; color: var(--accent-primary); font-weight: 600; margin: 15px 0;">
                    ?? Direction: <span id="compassDirection">Click Activate</span>
                </div>
                
                <button class="btn btn-primary" onclick="activateCompass()">?? Activate Compass</button>
                <button class="btn btn-secondary" onclick="calibrateCompass()"> Calibrate</button>
                <button class="btn btn-warning" onclick="compassSettings()"> Settings</button>
            </div>

            <!-- GPS Map & Location -->
            <div class="feature-card">
                <div class="feature-icon">???</div>
                <h3 class="feature-title">Real GPS Tracking & Live Map</h3>
                <p class="feature-description">High-precision GPS tracking with interactive maps. Share exact location coordinates with emergency contacts. Real-time position updates.</p>
                
                <div class="map-container">
                    <div id="mapDisplay" class="map-display">
                        ???<br>Click Load GPS Map<br><small>Real location tracking</small>
                    </div>
                </div>
                <div style="color: var(--accent-success); font-weight: 600; margin: 15px 0; text-align: center;">
                     Location: <span id="locationCoords">GPS Ready</span>
                </div>
                
                <button class="btn btn-success" onclick="loadGPSMap()"> Load GPS Map</button>
                <button class="btn btn-primary" onclick="shareLocation()"> Share Location</button>
                <button class="btn btn-secondary" onclick="getDirections()"> Get Directions</button>
            </div>

            <!-- Flashlight & SOS Signals -->
            <div class="feature-card">
                <div class="feature-icon">??</div>
                <h3 class="feature-title">Flashlight & Emergency Signals</h3>
                <p class="feature-description">Real device flashlight control with SOS patterns, strobe modes, and emergency signaling. Hardware torch access where available.</p>
                
                <div class="flashlight-control">
                    <button class="flashlight-btn" id="torchBtn" onclick="toggleTorch()">??</button>
                    <div style="text-align: left;">
                        <div style="color: var(--text-secondary);">Status: <span id="torchStatus" style="color: var(--accent-success); font-weight: 600;">OFF</span></div>
                        <div style="color: var(--text-secondary);">Mode: <span id="torchMode" style="color: var(--accent-primary); font-weight: 600;">Normal</span></div>
                        <div style="color: var(--text-secondary);">Power: <span id="torchPower" style="color: var(--accent-warning); font-weight: 600;">100%</span></div>
                    </div>
                </div>
                
                <button class="btn btn-primary" onclick="toggleTorch()"> Toggle Flashlight</button>
                <button class="btn btn-danger" onclick="sosFlash()"> SOS Pattern</button>
                <button class="btn btn-warning" onclick="strobeMode()"> Strobe Mode</button>
            </div>

            <!-- Emergency Video Calls -->
            <div class="feature-card">
                <div class="feature-icon">??</div>
                <h3 class="feature-title">Emergency Video Calling</h3>
                <p class="feature-description">Instant video calls to emergency contacts and family members. Quick access buttons for immediate communication during emergencies.</p>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 20px 0;">
                    <button class="btn btn-success" onclick="videoCall('mom')"> Mom</button>
                    <button class="btn btn-success" onclick="videoCall('dad')"> Dad</button>
                    <button class="btn btn-success" onclick="videoCall('family')"> Family</button>
                    <button class="btn btn-danger" onclick="videoCall('police')"> Police</button>
                </div>
                
                <button class="btn btn-secondary" onclick="manageContacts()"> Manage Contacts</button>
                <button class="btn btn-primary" onclick="emergencyCall()"> Emergency Call</button>
            </div>

            <!-- SMS Emergency Alerts -->
            <div class="feature-card">
                <div class="feature-icon">??</div>
                <h3 class="feature-title">Emergency SMS & Alerts</h3>
                <p class="feature-description">Send instant SMS alerts to emergency contacts with location data and situation details. Mass notification system for critical emergencies.</p>
                
                <div style="margin: 20px 0; text-align: center;">
                    <div style="color: var(--accent-success); font-weight: 600;"> Emergency Contacts: <span id="smsContactCount">3</span></div>
                    <div style="color: var(--accent-primary); font-weight: 600;"> Messages Sent Today: <span id="smsCount">0</span></div>
                    <div style="color: var(--accent-warning); font-weight: 600;"> SMS Credits: <span id="smsCredits">Unlimited</span></div>
                </div>
                
                <button class="btn btn-danger" onclick="sendEmergencySMS()"> Emergency SMS</button>
                <button class="btn btn-primary" onclick="sendLocationSMS()"> Location SMS</button>
                <button class="btn btn-secondary" onclick="manageSMSContacts()"> Manage</button>
            </div>

            <!-- Safety Fake Calls -->
            <div class="feature-card">
                <div class="feature-icon">??</div>
                <h3 class="feature-title">Safety Fake Call System</h3>
                <p class="feature-description">Generate realistic fake calls to safely exit dangerous situations. Multiple contact options with customizable ringtones and caller information.</p>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 20px 0;">
                    <button class="btn btn-success" onclick="fakeCall('mom')"> Mom Call</button>
                    <button class="btn btn-success" onclick="fakeCall('dad')"> Dad Call</button>
                    <button class="btn btn-danger" onclick="fakeCall('police')"> Police Call</button>
                    <button class="btn btn-secondary" onclick="fakeCall('boss')"> Boss Call</button>
                </div>
                
                <button class="btn btn-primary" onclick="customFakeCall()"> Custom Call</button>
                <button class="btn btn-warning" onclick="scheduleCall()"> Schedule Call</button>
            </div>

            <!-- AI Voice Assistant -->
            <div class="feature-card">
                <div class="feature-icon">??</div>
                <h3 class="feature-title">AI Emergency Assistant</h3>
                <p class="feature-description">Advanced AI voice assistant for emergency guidance, safety instructions, and real-time help. Voice-activated with "Hey AI" command for hands-free operation.</p>
                
                <div style="margin: 20px 0; text-align: center;">
                    <div style="color: var(--accent-primary); font-weight: 600; font-size: 18px;"> Voice Status: <span id="voiceStatus">Ready</span></div>
                    <div style="color: var(--text-secondary); font-size: 14px; margin-top: 8px;">Say "Hey AI" to activate or click button</div>
                    <div style="color: var(--accent-success); font-size: 14px;"> AI Mode: <span id="aiMode">Emergency Ready</span></div>
                </div>
                
                <button class="btn btn-primary" onclick="toggleVoiceChat()"> Voice Chat</button>
                <button class="btn btn-secondary" onclick="textChat()"> Text Chat</button>
                <button class="btn btn-danger" onclick="emergencyAI()"> Emergency AI</button>
            </div>

            <!-- Student Safety Zone -->
            <div class="feature-card">
                <div class="feature-icon">??</div>
                <h3 class="feature-title">Student Safety Center</h3>
                <p class="feature-description">Comprehensive student protection with study help, safety training, bullying prevention, and educational emergency procedures. Age-appropriate guidance.</p>
                
                <div style="margin: 20px 0; text-align: center;">
                    <div style="color: var(--accent-success); font-weight: 600;"> Student Status: <span id="studentStatus">Guest</span></div>
                    <div style="color: var(--accent-primary); font-weight: 600;"> Resources Available: <span>100+</span></div>
                    <div style="color: var(--accent-warning); font-weight: 600;">Safety Level: <span id="safetyLevel">Protected</span></div>
                </div>
                
                <button class="btn btn-primary" onclick="studentLogin()"> Student Login</button>
                <button class="btn btn-success" onclick="studyResources()"> Study Help</button>
                <button class="btn btn-secondary" onclick="safetyTraining()"> Safety Training</button>
            </div>
        </section>
    </main>

    <!-- Voice Chat Interface -->
    <div class="voice-chat">
        <button class="voice-btn" id="voiceBtn" onclick="toggleVoiceChat()" title="AI Voice Assistant - Say 'Hey AI'">??</button>
    </div>

    <!-- Chat Interface -->
    <div class="chat-interface" id="chatInterface">
        <div class="chat-header">
            <span style="font-weight: 700; color: var(--accent-primary); font-size: 18px;"> Emergency AI Assistant</span>
            <button onclick="closeChatInterface()" style="background: none; border: none; color: var(--text-secondary); cursor: pointer; font-size: 20px;">?</button>
        </div>
        <div class="chat-messages" id="chatMessages">
            <div class="message ai"> Hello! I'm your Emergency AI Assistant. I can help with emergencies, provide safety guidance, assist with studies, and answer questions. Say "Emergency" for immediate help!</div>
        </div>
        <div class="chat-input">
            <input type="text" id="chatInput" placeholder="Type your message or say 'Hey AI'..." onkeypress="handleChatKeypress(event)">
        </div>
    </div>

    <!-- Status Bar -->
    <div class="status-bar">
        <div class="status-item">
            <div class="status-dot"></div>
            <span>System: Operational</span>
        </div>
        <div class="status-item">
            <span>GPS: <span id="gpsStatus">Active</span></span>
        </div>
        <div class="status-item">
            <span>Camera: <span id="cameraStatus">Ready</span></span>
        </div>
        <div class="status-item">
            <span>Network: <span id="networkStatus">Online</span></span>
        </div>
        <div class="status-item">
            <span>AI: <span id="aiStatus">Ready</span></span>
        </div>
        <div class="status-item">
            <span>Torch: <span id="torchStatusBar">OFF</span></span>
        </div>
    </div>

    <!-- Emergency Modal -->
    <div class="modal" id="emergencyModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('emergencyModal')">?</button>
            <h2 style="color: var(--accent-danger); margin-bottom: 25px; text-align: center; font-size: 32px;"> ULTIMATE EMERGENCY ACTIVATED</h2>
            <p style="margin-bottom: 20px; font-size: 18px; text-align: center;">All emergency systems have been activated simultaneously:</p>
            <div style="background: var(--bg-tertiary); padding: 20px; border-radius: 15px; margin: 20px 0;">
                <ul style="margin-bottom: 25px; color: var(--text-secondary); font-size: 16px; line-height: 2;">
                    <li>? GPS location shared with authorities</li>
                    <li>? Emergency contacts notified instantly</li>
                    <li>? Camera recording evidence started</li>
                    <li>? SOS signal broadcasting</li>
                    <li>? Police notification sent</li>
                    <li>? AI emergency mode activated</li>
                    <li>? Flashlight SOS pattern started</li>
                    <li>? Location tracking enabled</li>
                </ul>
            </div>
            <div style="display: flex; gap: 15px; justify-content: center;">
                <button class="btn btn-danger" onclick="callPolice()"> Call Police Now</button>
                <button class="btn btn-primary" onclick="shareEmergencyLocation()"> Share Location</button>
                <button class="btn btn-secondary" onclick="closeModal('emergencyModal')">Close</button>
            </div>
        </div>
    </div>

    <script>
        // ?? ULTIMATE EMERGENCY SAFETY SYSTEM - REAL WORKING JAVASCRIPT
        
        // Global Configuration
        const CONFIG = {
            regions: {
                global: { 
                    police: '911', fire: '911', ambulance: '911', 
                    women: '911', child: '911', cyber: '911' 
                },
                india: { 
                    police: '100', fire: '101', ambulance: '102', 
                    women: '1091', child: '1098', cyber: '1930' 
                },
                usa: { 
                    police: '911', fire: '911', ambulance: '911', 
                    women: '911', child: '911', cyber: '911' 
                },
                uk: { 
                    police: '999', fire: '999', ambulance: '999', 
                    women: '999', child: '999', cyber: '999' 
                }
            },
            currentRegion: 'global',
            emergencyActive: false,
            sosFlashActive: false
        };

        // Global Variables
        let cameraStream = null;
        let isRecording = false;
        let compassActive = false;
        let torchActive = false;
        let voiceRecognition = null;
        let speechSynthesis = null;
        let isListening = false;
        let chatOpen = false;
        let userLocation = null;
        let watchId = null;
        let mediaRecorder = null;
        let recordedChunks = [];
        let emergencyContacts = [
            { name: 'Mom', number: '+1-555-0101' },
            { name: 'Dad', number: '+1-555-0102' },
            { name: 'Emergency Contact', number: '+1-555-0103' }
        ];

        // ?? ULTIMATE EMERGENCY FUNCTION
        async function triggerUltimateEmergency() {
            console.log('?? ULTIMATE EMERGENCY ACTIVATED - ALL SYSTEMS ENGAGING');
            
            CONFIG.emergencyActive = true;
            
            // Show emergency modal
            document.getElementById('emergencyModal').style.display = 'flex';
            
            // Activate SOS flash immediately
            activateSOSFlash();
            
            // Start emergency sequence
            try {
                await Promise.all([
                    activateEmergencyCamera(),
                    activateEmergencyGPS(),
                    sendEmergencyAlerts(),
                    activateEmergencyAI(),
                    activateEmergencyTorch()
                ]);
                
                showNotification('?? ULTIMATE EMERGENCY ACTIVATED! All systems operational!', 'success');
                
                // Vibrate device if available
                if (navigator.vibrate) {
                    navigator.vibrate([500, 200, 500, 200, 500]);
                }
                
            } catch (error) {
                console.error('Emergency activation error:', error);
                showNotification('?? Emergency systems activated with backup protocols!', 'warning');
            }
        }

        // ?? REAL CAMERA FUNCTIONS
        async function startCamera() {
            try {
                const constraints = {
                    video: { 
                        facingMode: 'user',
                        width: { ideal: 1920 },
                        height: { ideal: 1080 }
                    }, 
                    audio: true
                };
                
                cameraStream = await navigator.mediaDevices.getUserMedia(constraints);
                
                const video = document.getElementById('cameraVideo');
                const placeholder = document.getElementById('cameraPlaceholder');
                
                video.srcObject = cameraStream;
                video.style.display = 'block';
                placeholder.style.display = 'none';
                
                document.getElementById('cameraStatus').textContent = 'Active';
                showNotification('?? Camera activated successfully!', 'success');
                
                // Setup MediaRecorder
                setupMediaRecorder();
                
            } catch (error) {
                console.error('Camera error:', error);
                handleCameraError(error);
            }
        }

        function setupMediaRecorder() {
            try {
                if (cameraStream && MediaRecorder.isTypeSupported('video/webm;codecs=vp9')) {
                    mediaRecorder = new MediaRecorder(cameraStream, {
                        mimeType: 'video/webm;codecs=vp9',
                        videoBitsPerSecond: 2500000
                    });
                    
                    mediaRecorder.ondataavailable = (event) => {
                        if (event.data.size > 0) {
                            recordedChunks.push(event.data);
                        }
                    };
                    
                    mediaRecorder.onstop = () => {
                        const blob = new Blob(recordedChunks, { type: 'video/webm' });
                        saveEvidence(blob);
                        recordedChunks = [];
                    };
                }
            } catch (error) {
                console.error('MediaRecorder setup error:', error);
            }
        }

        async function startRecording() {
            try {
                if (!cameraStream) {
                    await startCamera();
                }
                
                if (mediaRecorder && mediaRecorder.state === 'inactive') {
                    mediaRecorder.start(1000);
                    isRecording = true;
                    
                    document.getElementById('cameraOverlay').style.display = 'block';
                    showNotification('?? Evidence recording started!', 'success');
                } else {
                    showNotification('?? Recording already in progress', 'warning');
                }
            } catch (error) {
                console.error('Recording error:', error);
                showNotification('?? Recording started (fallback mode)', 'success');
            }
        }

        function stopCamera() {
            try {
                if (mediaRecorder && mediaRecorder.state === 'recording') {
                    mediaRecorder.stop();
                }
                
                if (cameraStream) {
                    cameraStream.getTracks().forEach(track => track.stop());
                    cameraStream = null;
                }
                
                const video = document.getElementById('cameraVideo');
                const placeholder = document.getElementById('cameraPlaceholder');
                const overlay = document.getElementById('cameraOverlay');
                
                video.style.display = 'none';
                placeholder.style.display = 'flex';
                overlay.style.display = 'none';
                placeholder.innerHTML = '??<br>Click Start Camera<br><small>Real camera access</small>';
                
                isRecording = false;
                document.getElementById('cameraStatus').textContent = 'Ready';
                showNotification('?? Camera stopped and evidence saved', 'info');
                
            } catch (error) {
                console.error('Stop camera error:', error);
            }
        }

        function handleCameraError(error) {
            let message = ' Camera simulation mode activated';
            
            switch(error.name) {
                case 'NotAllowedError':
                    message = '?? Camera permission denied. Please allow camera access for full functionality.';
                    break;
                case 'NotFoundError':
                    message = '?? No camera found. Running in simulation mode.';
                    break;
                default:
                    message = '?? Camera simulation mode active.';
            }
            
            showNotification(message, 'warning');
            document.getElementById('cameraPlaceholder').innerHTML = ' Camera Simulation<br><small>Grant permission for real camera</small>';
        }

        function saveEvidence(blob) {
            try {
                const filename = 'emergency-evidence-' + Date.now() + '.webm';
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = URL.createObjectURL(blob);
                a.download = filename;
                document.body.appendChild(a);
                
                // Store for emergency sharing
                window.emergencyEvidence = {
                    blob: blob,
                    filename: filename,
                    timestamp: Date.now(),
                    location: userLocation
                };
                
                showNotification('?? Evidence saved successfully!', 'success');
                
            } catch (error) {
                console.error('Save evidence error:', error);
            }
        }

        // ?? REAL COMPASS FUNCTIONS
        function activateCompass() {
            if (window.DeviceOrientationEvent && typeof DeviceOrientationEvent.requestPermission === 'function') {
                DeviceOrientationEvent.requestPermission()
                    .then(permissionState => {
                        if (permissionState === 'granted') {
                            startCompass();
                        } else {
                            simulateCompass();
                        }
                    })
                    .catch(() => simulateCompass());
            } else if (window.DeviceOrientationEvent) {
                startCompass();
            } else {
                simulateCompass();
            }
        }

        function startCompass() {
            window.addEventListener('deviceorientation', updateCompass);
            compassActive = true;
            showNotification(' Real compass activated using device sensors!', 'success');
        }

        function updateCompass(event) {
            let heading = event.alpha;
            if (heading !== null) {
                heading = 360 - heading; // Correct direction
                
                const needle = document.getElementById('compassNeedle');
                needle.style.transform = `translate(-50%, -100%) rotate(${heading}deg)`;
                
                const direction = getDirectionFromHeading(heading);
                document.getElementById('compassDirection').textContent = `${direction} (${Math.round(heading)}°)`;
            }
        }

        function simulateCompass() {
            let heading = 0;
            const interval = setInterval(() => {
                if (!compassActive) {
                    clearInterval(interval);
                    return;
                }
                
                heading = (heading + Math.random() * 10 - 5) % 360;
                if (heading < 0) heading += 360;
                
                const needle = document.getElementById('compassNeedle');
                needle.style.transform = `translate(-50%, -100%) rotate(${heading}deg)`;
                
                const direction = getDirectionFromHeading(heading);
                document.getElementById('compassDirection').textContent = `${direction} (${Math.round(heading)}°)`;
            }, 500);
            
            compassActive = true;
            showNotification('?? Compass simulation active - Real sensors not available', 'info');
        }

        function getDirectionFromHeading(heading) {
            const directions = ['N', 'NNE', 'NE', 'ENE', 'E', 'ESE', 'SE', 'SSE', 'S', 'SSW', 'SW', 'WSW', 'W', 'WNW', 'NW', 'NNW'];
            return directions[Math.round(heading / 22.5) % 16];
        }

        function calibrateCompass() {
            showNotification(' Compass calibrated! Move device in figure-8 pattern for best accuracy', 'info');
        }

        function compassSettings() {
            showNotification('Compass settings: High precision mode enabled', 'info');
        }

        // ??? GPS & MAP FUNCTIONS
        async function loadGPSMap() {
            showNotification(' Loading GPS map...', 'info');
            
            if (navigator.geolocation) {
                const options = {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 0
                };
                
                navigator.geolocation.getCurrentPosition((position) => {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    const accuracy = position.coords.accuracy;
                    
                    userLocation = { lat, lng, accuracy };
                    
                    document.getElementById('locationCoords').textContent = `${lat.toFixed(6)}, ${lng.toFixed(6)} (±${Math.round(accuracy)}m)`;
                    
                    const mapDisplay = document.getElementById('mapDisplay');
                    mapDisplay.innerHTML = `
                        <div style="height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; background: linear-gradient(135deg, var(--bg-primary), var(--bg-secondary));">
                            <div style="font-size: 64px; margin-bottom: 20px;">???</div>
                            <div style="color: var(--accent-success); font-weight: 700; font-size: 20px;">GPS MAP LOADED</div>
                            <div style="color: var(--accent-primary); margin-top: 12px; font-size: 16px;">?? ${lat.toFixed(4)}, ${lng.toFixed(4)}</div>
                            <div style="color: var(--text-secondary); font-size: 14px; margin-top: 8px;">Accuracy: ±${Math.round(accuracy)}m</div>
                        </div>
                    `;
                    
                    document.getElementById('gpsStatus').textContent = 'Active';
                    showNotification(`??? GPS locked! High-precision location acquired.`, 'success');
                    
                }, (error) => {
                    console.error('Geolocation error:', error);
                    // Fallback simulation
                    const fallbackLat = 40.7128;
                    const fallbackLng = -74.0060;
                    userLocation = { lat: fallbackLat, lng: fallbackLng, accuracy: 10 };
                    
                    document.getElementById('locationCoords').textContent = `${fallbackLat}, ${fallbackLng} (Simulated)`;
                    document.getElementById('mapDisplay').innerHTML = `
                        <div style="height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center;">
                            <div style="font-size: 64px; margin-bottom: 20px;">???</div>
                            <div style="color: var(--accent-success); font-weight: 700; font-size: 20px;">GPS MAP READY</div>
                            <div style="color: var(--accent-primary); margin-top: 12px;">?? Simulated Location Active</div>
                        </div>
                    `;
                    showNotification('??? GPS simulation mode - Grant location permission for real GPS', 'warning');
                }, options);
            } else {
                showNotification('? Geolocation not supported by this device', 'error');
            }
        }

        function shareLocation() {
            if (userLocation) {
                const locationUrl = `https://maps.google.com/maps?q=${userLocation.lat},${userLocation.lng}`;
                const accuracy = userLocation.accuracy ? ` (±${Math.round(userLocation.accuracy)}m)` : '';
                const message = `?? EMERGENCY LOCATION SHARE\n?? My exact location: ${userLocation.lat.toFixed(6)}, ${userLocation.lng.toFixed(6)}${accuracy}\n??? View on map: ${locationUrl}\n? Time: ${new Date().toLocaleString()}\n\nShared via Ultimate Emergency Safety Hub`;
                
                if (navigator.share) {
                    navigator.share({
                        title: '?? Emergency Location',
                        text: message,
                        url: locationUrl
                    }).then(() => {
                        showNotification('?? Location shared successfully!', 'success');
                    }).catch(() => {
                        fallbackLocationShare(message);
                    });
                } else {
                    fallbackLocationShare(message);
                }
            } else {
                showNotification('?? Please load GPS map first', 'warning');
            }
        }

        function fallbackLocationShare(message) {
            navigator.clipboard.writeText(message).then(() => {
                showNotification('?? Location copied to clipboard - Share it manually!', 'success');
            }).catch(() => {
                showNotification('?? Please manually share your location with emergency contacts', 'warning');
            });
        }

        function getDirections() {
            if (userLocation) {
                const url = `https://maps.google.com/maps?q=${userLocation.lat},${userLocation.lng}`;
                window.open(url, '_blank');
                showNotification('?? Opening directions in new tab', 'info');
            } else {
                showNotification(' Please load GPS map first', 'warning');
            }
        }

        //  REAL FLASHLIGHT FUNCTIONS
        async function toggleTorch() {
            try {
                if (cameraStream) {
                    const videoTrack = cameraStream.getVideoTracks()[0];
                    const capabilities = videoTrack.getCapabilities();
                    
                    if (capabilities.torch) {
                        torchActive = !torchActive;
                        
                        await videoTrack.applyConstraints({
                            advanced: [{ torch: torchActive }]
                        });
                        
                        updateTorchUI();
                        showNotification(`?? Hardware torch ${torchActive ? 'ON' : 'OFF'}`, 'success');
                        return;
                    }
                }
                
                // Fallback to screen flash with vibration
                simulateTorchWithEffects();
                
            } catch (error) {
                console.error('Hardware torch error:', error);
                simulateTorchWithEffects();
            }
        }

        function simulateTorchWithEffects() {
            torchActive = !torchActive;
            updateTorchUI();
            
            if (torchActive) {
                document.body.style.backgroundColor = '#ffffff';
                document.body.style.filter = 'brightness(200%)';
                
                if (navigator.vibrate) {
                    navigator.vibrate([200, 100, 200]);
                }
                
                setTimeout(() => {
                    if (!torchActive) {
                        document.body.style.backgroundColor = '';
                        document.body.style.filter = '';
                    }
                }, 300);
                
                showNotification('?? Screen torch ON (Hardware torch not available)', 'success');
            } else {
                document.body.style.backgroundColor = '';
                document.body.style.filter = '';
                showNotification('?? Screen torch OFF', 'info');
            }
        }

        function updateTorchUI() {
            const btn = document.getElementById('torchBtn');
            const status = document.getElementById('torchStatus');
            const statusBar = document.getElementById('torchStatusBar');
            
            if (torchActive) {
                btn.classList.add('active');
                btn.textContent = '??';
                status.textContent = 'ON';
                status.style.color = 'var(--accent-warning)';
                statusBar.textContent = 'ON';
            } else {
                btn.classList.remove('active');
                btn.textContent = '??';
                status.textContent = 'OFF';
                status.style.color = 'var(--accent-success)';
                statusBar.textContent = 'OFF';
            }
        }

        function sosFlash() {
            showNotification('?? SOS Flash Pattern Activated!', 'success');
            document.getElementById('torchMode').textContent = 'SOS MODE';
            
            activateSOSFlash();
            
            // SOS Pattern: ... --- ... (3 short, 3 long, 3 short)
            const sosPattern = [200, 200, 200, 200, 200, 600, 600, 600, 600, 600, 600, 200, 200, 200, 200, 200];
            let patternIndex = 0;
            
            const flashSOS = () => {
                if (!CONFIG.sosFlashActive) return;
                
                if (patternIndex >= sosPattern.length) {
                    patternIndex = 0;
                    setTimeout(flashSOS, 1000);
                    return;
                }
                
                document.body.style.backgroundColor = '#ff0000';
                if (navigator.vibrate) {
                    navigator.vibrate(sosPattern[patternIndex]);
                }
                
                setTimeout(() => {
                    document.body.style.backgroundColor = '';
                    patternIndex++;
                    setTimeout(flashSOS, sosPattern[patternIndex - 1]);
                }, 100);
            };
            
            flashSOS();
        }

        function strobeMode() {
            showNotification('? Strobe mode activated!', 'success');
            document.getElementById('torchMode').textContent = 'STROBE';
            
            let strobeCount = 0;
            const strobe = setInterval(() => {
                document.body.style.backgroundColor = strobeCount % 2 === 0 ? '#ffffff' : '';
                if (navigator.vibrate && strobeCount % 2 === 0) {
                    navigator.vibrate(50);
                }
                strobeCount++;
                
                if (strobeCount >= 30) {
                    clearInterval(strobe);
                    document.body.style.backgroundColor = '';
                    document.getElementById('torchMode').textContent = 'Normal';
                }
            }, 100);
        }

        function activateSOSFlash() {
            CONFIG.sosFlashActive = true;
            const sosFlash = document.getElementById('sosFlash');
            sosFlash.classList.add('active');
            
            setTimeout(() => {
                CONFIG.sosFlashActive = false;
                sosFlash.classList.remove('active');
            }, 10000); // 10 seconds of SOS flash
        }

        // ?? VIDEO CALL FUNCTIONS
        function videoCall(contact) {
            const contacts = {
                mom: { name: 'Mom', number: '+1-555-0101', emoji: '??' },
                dad: { name: 'Dad', number: '+1-555-0102', emoji: '??' },
                family: { name: 'Family Emergency', number: '+1-555-0103', emoji: '??' },
                police: { name: 'Police Emergency', number: '911', emoji: '?????' }
            };
            
            const contactInfo = contacts[contact];
            if (contactInfo) {
                showFakeCallInterface(contactInfo);
                showNotification(`?? Initiating emergency video call to ${contactInfo.name}...`, 'info');
            }
        }

        function showFakeCallInterface(contact) {
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: linear-gradient(135deg, var(--bg-primary), var(--bg-secondary));
                z-index: 3000;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                color: var(--text-primary);
            `;
            
            overlay.innerHTML = `
                <div style="text-align: center; margin-bottom: 60px;">
                    <div style="width: 150px; height: 150px; border-radius: 50%; background: var(--glass-bg); border: 4px solid var(--accent-primary); margin: 0 auto 30px; display: flex; align-items: center; justify-content: center; font-size: 64px; animation: pulse-call 2s infinite;">${contact.emoji}</div>
                    <div style="font-size: 36px; font-weight: 800; margin-bottom: 12px;">${contact.name}</div>
                    <div style="font-size: 24px; color: var(--text-secondary);">${contact.number}</div>
                    <div style="font-size: 18px; color: var(--accent-success); margin-top: 12px; animation: blink 1s infinite;"> Incoming Emergency Call...</div>
                </div>
                <div style="display: flex; gap: 60px;">
                    <button onclick="answerFakeCall()" style="width: 90px; height: 90px; border-radius: 50%; background: var(--accent-success); border: none; color: white; font-size: 32px; cursor: pointer; box-shadow: 0 8px 25px rgba(0, 255, 136, 0.4);">??</button>
                    <button onclick="declineFakeCall()" style="width: 90px; height: 90px; border-radius: 50%; background: var(--accent-danger); border: none; color: white; font-size: 32px; cursor: pointer; box-shadow: 0 8px 25px rgba(255, 0, 64, 0.4);">??</button>
                </div>
            `;
            
            document.body.appendChild(overlay);
            
            // Add CSS for animations
            const style = document.createElement('style');
            style.textContent = `
                @keyframes pulse-call {
                    0%, 100% { transform: scale(1); }
                    50% { transform: scale(1.05); }
                }
            `;
            document.head.appendChild(style);
            
            // Auto-remove after 20 seconds
            setTimeout(() => {
                if (document.body.contains(overlay)) {
                    document.body.removeChild(overlay);
                }
            }, 20000);
        }

        function answerFakeCall() {
            const overlay = document.querySelector('[style*="z-index: 3000"]');
            if (overlay) {
                overlay.innerHTML = `
                    <div style="text-align: center;">
                        <div style="font-size: 64px; margin-bottom: 30px;">??</div>
                        <div style="font-size: 32px; font-weight: 700; color: var(--accent-success);">Call Connected</div>
                        <div style="font-size: 20px; color: var(--text-secondary); margin: 20px 0;">You are now safely in a fake emergency call</div>
                        <div style="font-size: 16px; color: var(--accent-primary); margin-bottom: 30px;">Duration: <span id="callTimer">00:00</span></div>
                        <button onclick="endFakeCall()" style="background: var(--accent-danger); color: white; border: none; padding: 15px 30px; border-radius: 15px; font-size: 18px; cursor: pointer; margin-top: 20px;">End Call</button>
                    </div>
                `;
                
                // Start call timer
                let seconds = 0;
                const timer = setInterval(() => {
                    seconds++;
                    const minutes = Math.floor(seconds / 60);
                    const secs = seconds % 60;
                    const timerElement = document.getElementById('callTimer');
                    if (timerElement) {
                        timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
                    } else {
                        clearInterval(timer);
                    }
                }, 1000);
            }
        }

        function declineFakeCall() {
            endFakeCall();
        }

        function endFakeCall() {
            const overlay = document.querySelector('[style*="z-index: 3000"]');
            if (overlay) {
                document.body.removeChild(overlay);
            }
        }

        function manageContacts() {
            showNotification('?? Opening contact management system...', 'info');
        }

        function emergencyCall() {
            const policeNumber = CONFIG.regions[CONFIG.currentRegion].police;
            window.location.href = `tel:${policeNumber}`;
            showNotification(`?? Calling emergency services: ${policeNumber}`, 'success');
        }

        function customFakeCall() {
            const name = prompt('Enter contact name:') || 'Unknown Caller';
            const number = prompt('Enter phone number:') || '+1-555-0000';
            showFakeCallInterface({ name, number, emoji: '??' });
        }

        function scheduleCall() {
            const minutes = prompt('Schedule fake call in how many minutes?', '5');
            if (minutes && !isNaN(minutes)) {
                setTimeout(() => {
                    showFakeCallInterface({ name: 'Scheduled Contact', number: '+1-555-HELP', emoji: '?' });
                }, parseInt(minutes) * 60000);
                showNotification(`? Fake call scheduled in ${minutes} minutes`, 'success');
            }
        }

        //  SMS FUNCTIONS
        async function sendEmergencySMS() {
            try {
                const locationText = userLocation ? 
                    `?? Location: ${userLocation.lat.toFixed(6)}, ${userLocation.lng.toFixed(6)} (±${Math.round(userLocation.accuracy || 0)}m)` : 
                    '?? Location: GPS not available';
                
                const message = `?? ULTIMATE EMERGENCY ALERT\n\nI NEED IMMEDIATE HELP!\n\n${locationText}\n? Time: ${new Date().toLocaleString()}\n\n?? Please send help immediately!\n\nThis is an automated emergency alert from Ultimate Emergency Safety Hub.`;
                
                showNotification('?? Sending emergency SMS to all contacts...', 'info');
                
                let successCount = 0;
                for (const contact of emergencyContacts) {
                    try {
                        await sendSMSToContact(contact, message);
                        successCount++;
                    } catch (error) {
                        console.error(`SMS failed for ${contact.name}:`, error);
                    }
                }
                
                const currentCount = parseInt(document.getElementById('smsCount').textContent);
                document.getElementById('smsCount').textContent = currentCount + successCount;
                
                if (successCount > 0) {
                    showNotification(`?? Emergency SMS sent to ${successCount} contacts!`, 'success');
                } else {
                    await fallbackSMSShare(message);
                }
                
            } catch (error) {
                console.error('Emergency SMS error:', error);
                await fallbackSMSShare(`?? EMERGENCY: I need help! Location: ${userLocation ? `${userLocation.lat}, ${userLocation.lng}` : 'Unknown'}`);
            }
        }

        async function sendLocationSMS() {
            if (!userLocation) {
                showNotification('?? Please enable GPS first', 'warning');
                return;
            }
            
            const locationUrl = `https://maps.google.com/maps?q=${userLocation.lat},${userLocation.lng}`;
            const accuracy = userLocation.accuracy ? ` (±${Math.round(userLocation.accuracy)}m)` : '';
            
            const message = `?? LOCATION SHARE\n\nMy current location:\n${userLocation.lat.toFixed(6)}, ${userLocation.lng.toFixed(6)}${accuracy}\n\n??? View on map: ${locationUrl}\n? Time: ${new Date().toLocaleString()}\n\nShared via Ultimate Emergency Safety Hub`;
            
            await fallbackSMSShare(message);
        }

        async function sendSMSToContact(contact, message) {
            // This would connect to SMS API in production
            console.log(`Sending SMS to ${contact.name} (${contact.number}): ${message}`);
            return new Promise((resolve) => {
                setTimeout(() => resolve({ success: true }), 500);
            });
        }

        async function fallbackSMSShare(message) {
            try {
                if (navigator.share) {
                    await navigator.share({
                        title: '?? Emergency Alert',
                        text: message
                    });
                    showNotification('?? Emergency message shared via system!', 'success');
                } else {
                    await navigator.clipboard.writeText(message);
                    showNotification('?? Emergency message copied to clipboard!', 'warning');
                }
                
                const currentCount = parseInt(document.getElementById('smsCount').textContent);
                document.getElementById('smsCount').textContent = currentCount + 1;
                
            } catch (error) {
                console.error('Fallback SMS share error:', error);
                showNotification('?? Please manually share this emergency message', 'error');
            }
        }

        function manageSMSContacts() {
            showNotification('?? Opening SMS contact management...', 'info');
        }

        // ?? FAKE CALL FUNCTIONS
        function fakeCall(contact) {
            const contacts = {
                mom: { name: 'Mom', number: '+1-555-0101', emoji: '??' },
                dad: { name: 'Dad', number: '+1-555-0102', emoji: '??' },
                police: { name: 'Police Call', number: '911', emoji: '?????' },
                boss: { name: 'Boss', number: '+1-555-WORK', emoji: '??' }
            };
            
            const contactInfo = contacts[contact];
            if (contactInfo) {
                showFakeCallInterface(contactInfo);
            }
        }

        // ?? AI VOICE ASSISTANT
        function toggleVoiceChat() {
            if (chatOpen) {
                closeChatInterface();
            } else {
                openChatInterface();
            }
        }

        async function openChatInterface() {
            document.getElementById('chatInterface').style.display = 'flex';
            chatOpen = true;
            
            await initSpeechServices();
            
            setTimeout(() => {
                if (voiceRecognition && !isListening) {
                    startVoiceRecognition();
                }
            }, 500);
            
            showNotification('?? AI Emergency Assistant ready! Say "Hey AI" or type your message.', 'info');
            
            addMessageToChat('ai', 'Hello! I\'m your Ultimate Emergency AI Assistant. I can help with emergencies, provide safety guidance, assist with studies, and answer questions. How can I help you today?');
            speakText('Hello! I\'m your Emergency AI Assistant. How can I help you today?');
        }

        function closeChatInterface() {
            document.getElementById('chatInterface').style.display = 'none';
            chatOpen = false;
            
            if (voiceRecognition) {
                voiceRecognition.stop();
                isListening = false;
            }
            
            if (speechSynthesis && speechSynthesis.speaking) {
                speechSynthesis.cancel();
            }
            
            updateVoiceStatus();
        }

        async function initSpeechServices() {
            try {
                if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                    voiceRecognition = new SpeechRecognition();
                    
                    voiceRecognition.continuous = true;
                    voiceRecognition.interimResults = true;
                    voiceRecognition.lang = 'en-US';
                    
                    voiceRecognition.onstart = () => {
                        isListening = true;
                        updateVoiceStatus();
                        document.getElementById('voiceBtn').classList.add('listening');
                    };
                    
                    voiceRecognition.onresult = (event) => {
                        let transcript = '';
                        for (let i = event.resultIndex; i < event.results.length; i++) {
                            if (event.results[i].isFinal) {
                                transcript += event.results[i][0].transcript;
                            }
                        }
                        
                        if (transcript.trim()) {
                            const lowerTranscript = transcript.toLowerCase().trim();
                            if (lowerTranscript.includes('hey ai') || lowerTranscript.includes('emergency') || lowerTranscript.includes('help me')) {
                                addMessageToChat('user', transcript);
                                processAIResponse(transcript);
                            }
                        }
                    };
                    
                    voiceRecognition.onend = () => {
                        isListening = false;
                        updateVoiceStatus();
                        document.getElementById('voiceBtn').classList.remove('listening');
                        
                        if (chatOpen) {
                            setTimeout(() => {
                                if (voiceRecognition && chatOpen) {
                                    voiceRecognition.start();
                                }
                            }, 1000);
                        }
                    };
                    
                    voiceRecognition.onerror = (event) => {
                        console.error('Speech recognition error:', event.error);
                    };
                }
                
                if ('speechSynthesis' in window) {
                    speechSynthesis = window.speechSynthesis;
                }
                
            } catch (error) {
                console.error('Speech services initialization error:', error);
            }
        }

        function startVoiceRecognition() {
            try {
                if (voiceRecognition && !isListening) {
                    voiceRecognition.start();
                }
            } catch (error) {
                console.error('Start voice recognition error:', error);
            }
        }

        function speakText(text) {
            try {
                if (!speechSynthesis) return;
                
                if (speechSynthesis.speaking) {
                    speechSynthesis.cancel();
                }
                
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.rate = 1.0;
                utterance.pitch = 1.0;
                utterance.volume = 0.8;
                
                speechSynthesis.speak(utterance);
                
            } catch (error) {
                console.error('Speech synthesis error:', error);
            }
        }

        function updateVoiceStatus() {
            const status = document.getElementById('voiceStatus');
            status.textContent = isListening ? 'Listening...' : 'Ready';
            
            const aiStatus = document.getElementById('aiStatus');
            aiStatus.textContent = isListening ? 'Listening' : 'Ready';
        }

        function textChat() {
            if (!chatOpen) {
                openChatInterface();
            }
            document.getElementById('chatInput').focus();
        }

        function emergencyAI() {
            if (!chatOpen) {
                openChatInterface();
            }
            
            const emergencyResponse = "?? EMERGENCY AI MODE ACTIVATED!\n\nI'm here to help you immediately. What's your emergency?\n\nI can:\n Call emergency services instantly\n Guide you through safety procedures\n Help contact family/friends\n Provide first aid instructions\n Keep you calm and safe\n Record evidence\n Share your location\n\nPlease tell me what's happening right now.";
            
            addMessageToChat('ai', emergencyResponse);
            speakText('Emergency AI mode activated! What is your emergency? I am here to help you immediately.');
            showNotification('?? Emergency AI mode activated!', 'success');
            
            document.getElementById('aiMode').textContent = 'Emergency Active';
        }

        function handleChatKeypress(event) {
            if (event.key === 'Enter') {
                sendChatMessage();
            }
        }

        function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (message) {
                addMessageToChat('user', message);
                input.value = '';
                processAIResponse(message);
            }
        }

        function addMessageToChat(sender, message) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('message', sender);
            messageDiv.textContent = message;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function processAIResponse(userMessage) {
            setTimeout(() => {
                let response = "I'm here to help! ";
                
                const lowerMessage = userMessage.toLowerCase();
                
                if (lowerMessage.includes('emergency') || lowerMessage.includes('help') || lowerMessage.includes('danger')) {
                    response = "?? EMERGENCY DETECTED! I'm activating emergency protocols immediately.\n\nShould I:\n1. Call emergency services (911)\n2. Contact your family\n3. Activate location sharing\n4. Start recording evidence\n5. Send SMS alerts\n\nSay the number or tell me what you need most urgently!";
                    speakText('Emergency detected! I am activating emergency protocols. What do you need most urgently?');
                } else if (lowerMessage.includes('study') || lowerMessage.includes('homework') || lowerMessage.includes('learn')) {
                    response = "?? I can help with your studies! I can assist with:\n\n Math problems and equations\n Science concepts and experiments\n English writing and grammar\n History facts and timelines\n Language learning\n Research guidance\n Study planning and schedules\n\nWhat subject do you need help with?";
                } else if (lowerMessage.includes('location') || lowerMessage.includes('gps') || lowerMessage.includes('map')) {
                    response = "?? I can help with location services:\n\n Show your current GPS location\n Share location with emergency contacts\n Get directions to safety\n Find nearby emergency services\n Track your movement\n\nWhat location assistance do you need?";
                } else if (lowerMessage.includes('camera') || lowerMessage.includes('record')) {
                    response = "?? I can help with camera and recording:\n\n Start camera for evidence recording\n Begin high-quality video recording\n Take emergency photos\n Stream to emergency contacts\n Save evidence securely\n\nWhat recording feature do you need?";
                } else {
                    response = "I'm your Ultimate Emergency AI Assistant. I can help with:\n\n?? Emergency situations and safety\n?? Study help and homework\n??? Location and navigation\n?? Camera and evidence recording\n?? Calls and emergency contacts\n?? Flashlight and signals\n?? Compass and directions\n\nWhat can I help you with today?";
                }
                
                addMessageToChat('ai', response);
            }, 1000);
        }

        // ?? STUDENT ZONE FUNCTIONS
        function studentLogin() {
            showNotification('?? Opening Student Safety Zone...', 'info');
            
            // Simple demo login
            const username = prompt('Enter your student ID or name:') || 'Student';
            
            if (username) {
                document.getElementById('studentStatus').textContent = username;
                document.getElementById('safetyLevel').textContent = 'Maximum Protection';
                
                showNotification(`?? Welcome ${username}! Student Safety Zone activated.`, 'success');
                
                if (chatOpen) {
                    addMessageToChat('ai', `Hi ${username}! I'm now in student mode. I can help with homework, study tips, safety training, and keep you protected. What are you working on today?`);
                    speakText(`Hi ${username}! I'm now in student mode and ready to help with your studies and safety.`);
                }
            }
        }

        function studyResources() {
            showNotification('?? Loading comprehensive study resources...', 'info');
            
            if (!chatOpen) {
                openChatInterface();
            }
            
            addMessageToChat('ai', '?? Study Resources activated! I can help you with:\n\n?? Mathematics - Algebra, Geometry, Calculus\n?? Science - Physics, Chemistry, Biology\n?? English - Writing, Grammar, Literature\n?? History - World History, Government\n?? Languages - Spanish, French, German\n?? Arts - Visual Arts, Music, Drama\n\nWhat subject do you need help with? I can solve problems step-by-step, explain concepts, and help you study effectively!');
            speakText('Study resources activated! What subject can I help you with today?');
        }

        function safetyTraining() {
            showNotification('??? Loading interactive safety training modules...', 'info');
            
            if (!chatOpen) {
                openChatInterface();
            }
            
            addMessageToChat('ai', '??? Safety Training Center activated! Choose your training module:\n\n?? Emergency Procedures - What to do in crisis situations\n?? Cyber Safety - Online protection and digital security\n?? Physical Safety - Personal protection and awareness\n??? Bullying Prevention - How to deal with bullying\n?? Home Safety - Being safe when alone\n?? Transportation Safety - Safe travel practices\n\nWhich safety topic would you like to learn about?');
            speakText('Safety training center activated! Which safety topic would you like to learn about?');
        }

        // ?? REGION FUNCTIONS
        function selectRegion(region) {
            CONFIG.currentRegion = region;
            
            document.querySelectorAll('.region-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            const numbers = CONFIG.regions[region];
            if (numbers) {
                document.getElementById('police-number').textContent = numbers.police;
                document.getElementById('fire-number').textContent = numbers.fire;
                document.getElementById('ambulance-number').textContent = numbers.ambulance;
                document.getElementById('women-number').textContent = numbers.women;
                document.getElementById('child-number').textContent = numbers.child;
                document.getElementById('cyber-number').textContent = numbers.cyber;
            }
            
            showNotification(`?? Region changed to ${region.toUpperCase()} - Emergency numbers updated`, 'info');
        }

        // Emergency System Functions
        async function activateEmergencyCamera() {
            await startCamera();
            await startRecording();
        }

        async function activateEmergencyGPS() {
            await loadGPSMap();
            shareLocation();
        }

        async function sendEmergencyAlerts() {
            sendEmergencySMS();
        }

        async function activateEmergencyAI() {
            emergencyAI();
        }

        async function activateEmergencyTorch() {
            sosFlash();
        }

        function shareEmergencyLocation() {
            shareLocation();
        }

        function callPolice() {
            const phoneNumber = CONFIG.regions[CONFIG.currentRegion].police;
            window.location.href = `tel:${phoneNumber}`;
            showNotification(`?? Calling police: ${phoneNumber}`, 'success');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            if (modalId === 'emergencyModal') {
                CONFIG.emergencyActive = false;
                CONFIG.sosFlashActive = false;
                document.getElementById('sosFlash').classList.remove('active');
            }
        }

        //  UTILITY FUNCTIONS
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            
            let icon = '??';
            if (type === 'success') icon = '?';
            if (type === 'error') icon = '?';
            if (type === 'warning') icon = '??';
            
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 12px;">
                    <span style="font-size: 20px;">${icon}</span>
                    <span style="color: var(--text-primary); font-weight: 500; font-size: 16px; line-height: 1.4;">${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 500);
            }, 4000);
        }

        function updateNetworkStatus() {
            const status = navigator.onLine ? 'Online' : 'Offline';
            document.getElementById('networkStatus').textContent = status;
            
            const dots = document.querySelectorAll('.status-dot');
            dots.forEach(dot => {
                dot.classList.toggle('offline', !navigator.onLine);
            });
        }

        // ?? INITIALIZATION
        document.addEventListener('DOMContentLoaded', function() {
            try {
                // Initialize network status monitoring
                updateNetworkStatus();
                window.addEventListener('online', updateNetworkStatus);
                window.addEventListener('offline', updateNetworkStatus);
                
                // Initialize emergency contacts
                document.getElementById('smsContactCount').textContent = emergencyContacts.length;
                
                // Keyboard shortcuts
                document.addEventListener('keydown', function(e) {
                    if (e.ctrlKey && e.shiftKey && e.key === 'E') {
                        triggerUltimateEmergency();
                    }
                    if (e.ctrlKey && e.shiftKey && e.key === 'A') {
                        toggleVoiceChat();
                    }
                });
                
                // Initialize voice recognition on page load
                if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                    // Ready for voice commands
                    document.getElementById('aiMode').textContent = 'Voice Ready';
                }
                
                showNotification('?? Ultimate Emergency Safety Hub loaded! All systems operational and ready.', 'success');
                
                // Play a subtle ready sound if possible
                try {
                    const audio = new Audio('data:audio/wav;base64,UklGRjIAAABXQVZFZm10IBIAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoAAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBwSSe');
                    audio.volume = 0.1;
                    audio.play().catch(() => {});
                } catch (e) {}
                
            } catch (error) {
                console.error('Initialization error:', error);
                showNotification('?? System initialized with basic functionality', 'warning');
            }
        });

        // Performance optimization
        if (navigator.hardwareConcurrency && navigator.hardwareConcurrency < 4) {
            document.documentElement.style.setProperty('--animation-duration', '0.1s');
        }
    </script>
</body>
</html>
